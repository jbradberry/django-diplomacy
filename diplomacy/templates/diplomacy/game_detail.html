{% extends "diplomacy/base.html" %}

{% block title %}{{ game.name }} | Games | Diplomacy{% endblock %}
  
{% block extra_head %}
    <link rel="stylesheet" href="/diplomacy/media/css/game.css"
      type="text/css">
    <script type="text/javascript"
    src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js">
    </script>
    <script type="text/javascript">
      function colormap(lst) {
        var map = $("#map")[0].getSVGDocument();
        $.each(lst, function(i, v) {
          var id = "#"+v[0];
          var territory = $(map).find(id)[0];
          territory.style.setProperty("fill", v[1], "");
        });
      }

      $("#map").ready(function() {
        $.getJSON("state/", {}, colormap);
      });
    </script>
{% endblock %}

{% block page_title %}{{ game.name }}{% endblock %}

{% block breadcrumbs %}
<a href="/diplomacy/">Diplomacy</a>
&rsaquo;
<a href="/diplomacy/games/">Games</a>
&rsaquo;
{{ game.name }}
{% endblock %}
    
{% block content %}
    <h2>{{ game.current_turn }}</h2>

    {% block map %}
    <object type="image/svg+xml" data="/diplomacy/media/img/map.svg"
      height=400 id="map">
      Browser does not support SVG!
    </object>
    {% endblock %}

    <table>
      <thead>
	<tr>
	  <th>Name</th>
	  <th>Power</th>
	  <th>SC</th>
	</tr>
      </thead>
      {% for government in game.governments %}
      <tr class="{{ government.power }}">
	<td>{{ government }}</td>
	<td><a href="orders/{{ government.power|lower }}/">{{ government.power }}</a></td>
	<td>{{ government.supplycenters }}</td>
      </tr>
      {% endfor %}
    </table>
{% endblock %}
